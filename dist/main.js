(()=>{"use strict";class e{static turn="player";static players=[];static boards=[];static mode="PvP";static wasHit=!1;static cpuAttacked=[];static gameOver=!1;static justSunk="";static sunkEventFlag=!1}class t{static cpuLastHit=[];static cpuTargetingAid=[];static attempts=0}class n{static axis="x";static currentShip=[];static currentShipIndex=0;static currentPlacementBoard="player"}class s{static volume=1;static song="assets/sfx/we-are-8-bit.mp3";static currentlyPlaying={}}const a=class{constructor(e="Computer"){this.name=e}previousHit=[];attack(e,t){let n=[parseInt(e[0]),parseInt(e[1])];if(0===t.recordAttack.length)return t.receiveAttack(n),!0;for(let e=0;e<t.recordAttack.length;e++)return(n[0]!=t.recordAttack[e][0]||n[1]!=t.recordAttack[e][1])&&(t.receiveAttack(n),!0)}_cpuAttack(e){let t=Math.floor(10*Math.random()),n=Math.floor(10*Math.random());if(!this._onAvailableSpace([t,n],e))return this._cpuAttack(e);this.attack([t,n],e)}_defineAxis(){return 1===Math.floor(2*Math.random())?"x":"y"}_cpuSmartMove(e){const n=[[...t.cpuLastHit][0][0],[...t.cpuLastHit][0][1]];let s=[],a=n[0],i=n[1];return 0===t.attempts&&(a++,s.push(a),s.push(i)),1===t.attempts&&(i++,s.push(a),s.push(i)),2===t.attempts&&(i--,s.push(a),s.push(i)),3===t.attempts&&(a--,s.push(a),s.push(i)),-1===s[0]||-1===s[1]||10===s[0]||10===s[1]||!this._onAvailableSpace(s,e)&&t.attempts<4?(t.attempts++,this._cpuSmartMove(e)):this._onAvailableSpace(s,e)&&t.attempts<4?(t.attempts=0,this.attack(s,e)):(t.attempts=0,void this._cpuAttack(e))}_onAvailableSpace(e,t){for(let n=0;n<t.recordAttack.length;n++)if(e[0]===t.recordAttack[n][0]&&e[1]===t.recordAttack[n][1])return!1;return!0}cpuAttackPattern(e){0===t.cpuLastHit.length?this._cpuAttack(e):this._cpuSmartMove(e)}};function i(){const e=new Audio("assets/sfx/hit.wav");return e.volume=s.volume,e}function r(){const e=new Audio("assets/sfx/miss.mp3");return e.volume=s.volume,e}const l=class{constructor(e,t=null){this.name=t,this.length=e,this.hitCoordinates=[]}getHitCoordinates(){return this.hitCoordinates}hit(e){this.hitCoordinates.push(e)}isSunk(){return this.length===this.hitCoordinates.length}},o=class{constructor(e,t=10){this.name=e,this.size=t}shipCoordinates=[];recordAttack=[];sunkShips=[];receiveAttack(n){this.recordAttack.push(n),"computer"===e.turn&&e.cpuAttacked.push(n);for(let s=0;s<this.shipCoordinates.length;s++)for(let a=0;a<this.shipCoordinates[s].location.length;a++)if(n[0]===this.shipCoordinates[s].location[a][0]&&n[1]===this.shipCoordinates[s].location[a][1])return this.shipCoordinates[s].object.hit(n),e.wasHit=!0,"computer"===e.turn&&(t.cpuLastHit.push(n),2===t.cpuLastHit.length&&t.cpuLastHit.shift()),this.shipCoordinates[s].object.isSunk()&&(this.sunkShips.push(this.shipCoordinates[s].object),e.justSunk=this.shipCoordinates[s].object.name,e.sunkEventFlag=!0,"computer"===e.turn&&(t.cpuLastHit=[])),!0;return!1}removeShip(){return this.shipCoordinates.pop()}addShip(e,t){this.shipCoordinates.push({object:e,location:t})}randomAddShips(){let e=new l(5,"Carrier"),t=new l(4,"Battleship"),n=new l(2,"Destroyer"),s=new l(3,"Cruiser"),a=new l(3,"Submarine");this._randomizeShips(e),this._randomizeShips(t),this._randomizeShips(s),this._randomizeShips(n),this._randomizeShips(a)}_isEmptySpace(e){for(let t=0;t<e.length;t++)for(let n=0;n<this.shipCoordinates.length;n++)for(let s=0;s<this.shipCoordinates[n].location.length;s++)if(e[t][0]===this.shipCoordinates[n].location[s][0]&&e[t][1]===this.shipCoordinates[n].location[s][1])return!1;return!0}_randomizeShips(e,t=10){let n=[];const s=e.length;let a=this._defineAxis(),i=Math.floor(10*Math.random()),r=Math.floor(10*Math.random());if(n.push([i,r]),"x"===a&&i+s<=t)for(let e=0;e<s-1;e++)i++,n.push([i,r]);else if("x"===a&&i+s>t)for(let e=0;e<s-1;e++)i--,n.push([i,r]);if("y"===a&&r+s<=t)for(let e=0;e<s-1;e++)r++,n.push([i,r]);else if("y"===a&&r+s>t)for(let e=0;e<s-1;e++)r--,n.push([i,r]);if(!this._isEmptySpace(n))return this._randomizeShips(e,t);this.addShip(e,n)}_defineAxis(){return 1===Math.floor(2*Math.random())?"x":"y"}getSunkShips(){return this.sunkShips}allShipsSunk(){return 5===this.sunkShips.length}};function c(e){const t=d(e),n=document.getElementById("current-opponent-board");for(let s=0;s<e*e;s++){const e=document.createElement("div");e.className="opponent-grid-elements",e.id=`b${t.next().value}`,u(e),n.appendChild(e)}}function*d(e){let t=[0,0];for(;t[0]<=e-1&&t[1]<=e-1;)0===t[0]&&0===t[1]&&(yield t),t[1]++,t[1]===e&&(t[0]++,t[1]=0),yield t}function u(t){t.addEventListener("click",(()=>{let n="";const s=i(),a=r(),l=document.getElementById("turn");if("player"!==e.turn)return void u(t);const o=[...e.players][0],c=[...e.boards][1],d=t.id.slice(1).split(",");o.attack(d,c),c.allShipsSunk()&&(e.gameOver=!0,x()),!0===e.wasHit?(s.play(),t.classList.add("hit"),n="Its a hit!",!0===e.sunkEventFlag&&(n=`You sunk the ${e.justSunk}!`,e.sunkEventFlag=!1),e.wasHit=!1):(a.play(),n="Miss...",t.classList.add("miss")),"PvP"===e.mode?(e.turn="opponent",l.textContent=`${n} It's ${m()}'s Turn!`):"PvC"===e.mode&&(e.turn="computer",l.textContent=`${n} It's ${m()}'s Turn!`,async function(){let t="";const n=document.getElementById("turn");await function(){const e=1500*Math.random();return new Promise((t=>setTimeout(t,e)))}();const s=i(),a=r(),l=[...e.players][1],o=[...e.boards][0];l.cpuAttackPattern(o);let c=[...e.cpuAttacked][0][0]+","+[...e.cpuAttacked][0][1];e.cpuAttacked=[];const d=document.getElementById(`a${c}`);o.allShipsSunk()&&(e.gameOver=!0,x()),!0===e.wasHit?(s.play(),d.classList.remove("reveal"),d.classList.add("hit"),t="Its a hit!",!0===e.sunkEventFlag&&(t=`Computer sunk the ${e.justSunk}!`,e.sunkEventFlag=!1),e.wasHit=!1):(a.play(),t="Miss...",d.classList.add("miss")),e.turn="player",n.textContent=`${t} It's ${m()}'s Turn!`}())}),{once:!0})}function p(t){t.addEventListener("click",(()=>{const n=i(),s=r();let a="";const l=document.getElementById("turn");if("player"===e.turn)return void p(t);const o=[...e.players][1],c=[...e.boards][0],d=t.id.slice(1).split(",");"PvP"===e.mode&&(o.attack(d,c),!0===e.wasHit?(n.play(),t.classList.add("hit"),a="Its a hit!",!0===e.sunkEventFlag&&(a=`You sunk the ${e.justSunk}!`,e.sunkEventFlag=!1),e.wasHit=!1):(s.play(),t.classList.add("miss"),a="Miss...")),c.allShipsSunk()&&(e.gameOver=!0,x()),e.turn="player",l.textContent=`${a} It's ${m()}'s Turn!`}),{once:!0})}function m(){const t=[...e.boards][0],n=[...e.boards][1];switch(e.turn){case"player":return""===t.name?"Player 1":t.name;case"opponent":return""===n.name?"Player 2":n.name;case"computer":return"Computer"}}function h(t){t.addEventListener("dragover",(e=>{e.preventDefault();let s=t.id;if(s=s.split(","),"x"===n.axis)for(let e=0;e<n.currentShip[n.currentShipIndex].shipObj.length;e++){let t=s[0]+","+(parseInt(s[1])+e);document.getElementById(`${t}`)}})),t.addEventListener("dragleave",(e=>{let s=t.id;if(s=s.split(","),"x"===n.axis)for(let e=0;e<n.currentShip[n.currentShipIndex].shipObj.length;e++){let t=s[0]+","+(parseInt(s[1])+e);document.getElementById(`${t}`)}})),t.addEventListener("drop",(s=>{s.preventDefault();let a=t.id;a=a.split(",");let i=[];if("x"===n.axis&&parseInt(a[1])+n.currentShip[n.currentShipIndex].shipObj.length-1>9||"y"===n.axis&&parseInt(a[0])+n.currentShip[n.currentShipIndex].shipObj.length-1>9)return!1;if("x"===n.axis)for(let e=0;e<n.currentShip[n.currentShipIndex].shipObj.length;e++)i.push([parseInt(a[0]),parseInt(a[1])+e]);if("y"===n.axis)for(let e=0;e<n.currentShip[n.currentShipIndex].shipObj.length;e++)i.push([parseInt(a[0])+e,parseInt(a[1])]);if(!function(t){let s;s="player"===n.currentPlacementBoard?[...e.boards][0]:[...e.boards][1];for(let e=0;e<t.length;e++)for(let n=0;n<s.shipCoordinates.length;n++)for(let a=0;a<s.shipCoordinates[n].location.length;a++)if(t[e][0]===s.shipCoordinates[n].location[a][0]&&t[e][1]===s.shipCoordinates[n].location[a][1])return!1;return!0}(i))return!1;const r=s.dataTransfer.getData("text"),l=document.getElementById(r);var o;s.target.appendChild(l),l.setAttribute("draggable",!1),o=i,"player"===n.currentPlacementBoard?[...e.boards][0].addShip([...n.currentShip][n.currentShipIndex].shipObj,o):"opponent"===n.currentPlacementBoard&&[...e.boards][1].addShip([...n.currentShip][n.currentShipIndex].shipObj,o),g(),y(),n.currentShipIndex<5&&f()}))}function y(){if(n.currentShipIndex++,n.currentShipIndex>=5){const t=document.getElementById("game"),s=document.getElementById("placement-page-body-container");if("PvC"===e.mode)[...e.boards][1].randomAddShips();else if("PvP"===e.mode&&"player"===n.currentPlacementBoard)return function(){g(),n.currentShip=[],n.currentShipIndex=0,n.currentPlacementBoard="opponent";const e=document.getElementById("placement-board");for(;e.firstChild;)e.removeChild(e.lastChild);const t=document.getElementById("unplaced-ship-container");for(;t.firstChild;)t.lastChild.className="",t.removeChild(t.lastChild)}(),v();s.style.display="none",t.style.display="flex",function(t=10){!async function(){const e=await fetch("https://api.giphy.com/v1/gifs/o0eOCNkn7cSD6?api_key=XQjjxBQQYTlh7yBaVu1JXQ6YbH5dno3B&s=cats",{mode:"cors"}),t=await e.json();document.getElementById("gg-img").src=t.data.images.original.url}();const n=document.getElementById("game");document.body.style.backgroundImage="none",async function(){const e=await fetch("https://api.giphy.com/v1/gifs/XPlcxsFs8BIKk?api_key=XQjjxBQQYTlh7yBaVu1JXQ6YbH5dno3B&s=cats",{mode:"cors"}),t=await e.json();document.body.style.backgroundImage=`url(${t.data.images.original.url})`}();const s=document.getElementById("placement-page-body-container");!function(){const t=[...e.boards][0],n=[...e.boards][1],s=document.getElementById("player-name"),a=document.getElementById("player-2-name");""===t.name?s.textContent="Player 1":s.textContent=`${t.name}`,""===n.name?a.textContent="Player 2":a.textContent=`${n.name}`}(),function(e){const t=d(e),n=document.getElementById("current-player-board");for(let s=0;s<e*e;s++){const e=document.createElement("div");e.className="player-grid-elements",e.id=`a${t.next().value}`,p(e),n.appendChild(e)}}(t),"PvP"===e.mode?c(t):"PvC"===e.mode&&(function(){let t="";const n=[...e.boards][0];for(let e=0;e<n.shipCoordinates.length;e++)for(let s=0;s<n.shipCoordinates[e].location.length;s++)t=n.shipCoordinates[e].location[s][0]+","+n.shipCoordinates[e].location[s][1],document.getElementById(`a${t}`).classList.add("reveal")}(),c(t)),s.style.display="none",n.style.display="flex",document.getElementById("turn").textContent=`${m()} start your offensive!`}()}}function g(){n.axis="x",document.getElementById("unplaced-ship-container").style.height="fit-content"}function f(){const e=document.createElement("img");e.className="ship-img";const t=document.getElementById("ship-name"),s=document.getElementById("ship-length");document.getElementById("unplaced-ship-container").appendChild(e),function(){let e;n.currentPlacementBoard,e=document.getElementsByClassName("ship-img")[n.currentShipIndex],e.addEventListener("dragstart",(e=>{e.dataTransfer.clearData(),e.dataTransfer.setData("text/plain",e.target.id)}))}(),e.id=`${[...n.currentShip][n.currentShipIndex].shipObj.name}`,e.src=`${[...n.currentShip][n.currentShipIndex].shipSrcImg}`,t.textContent=`Name: ${[...n.currentShip][n.currentShipIndex].shipObj.name}`,s.textContent=`Length: ${[...n.currentShip][n.currentShipIndex].shipObj.length}`,e.setAttribute("draggable",!0)}function v(){document.getElementById("randomize-button").addEventListener("click",I);const t=document.getElementById("placement-board-name");let s=[...e.players][1].name;""===s&&(s="Player 2"),t.textContent=`${s}'s board`,document.getElementById("placement-page-body-container").display="flex",function(e=10){const t=d(e),n=document.getElementById("placement-board");for(let s=0;s<e*e;s++){const e=document.createElement("div");e.id=`${t.next().value}`,h(e),n.appendChild(e)}}(),function(){let e=[{shipObj:new l(5,"carrier"),shipSrcImg:"assets/ships/carrier.png"},{shipObj:new l(4,"battleship"),shipSrcImg:"assets/ships/battleship.png"},{shipObj:new l(2,"destroyer"),shipSrcImg:"assets/ships/gamsi.png"},{shipObj:new l(3,"cruiser"),shipSrcImg:"assets/ships/frigate.png"},{shipObj:new l(3,"submarine"),shipSrcImg:"assets/ships/submarine.png"}];n.currentShip=e}(),"player"===n.currentPlacementBoard&&(s=[...e.players][0].name,""===s&&(s="Player 1"),t.textContent=`${s}'s board`,f(),function(){const e=document.getElementById("unplaced-ship-container"),t=6*[...n.currentShip][n.currentShipIndex].shipObj.length;document.getElementById("change-orientation").addEventListener("click",(()=>{let s=document.getElementsByClassName("ship-img");"x"===n.axis?(n.axis="y",s[n.currentShipIndex].classList.add("y"),e.style.height=`${t}vh`):(n.axis="x",s[n.currentShipIndex].classList.remove("y"),e.style.height="fit-content")}))}())}function I(){"player"===n.currentPlacementBoard?(document.getElementById("randomize-button").removeEventListener("click",I),[...e.boards][0].randomAddShips(),n.currentShipIndex=5,y(),"PvP"===e.mode&&f()):"opponent"===n.currentPlacementBoard&&([...e.boards][1].randomAddShips(),n.currentShipIndex=5,y())}function E(){v()}function x(){!function(){const t=document.getElementById("game-over-modal"),n=document.getElementById("winner-name"),s=document.getElementById("num-remaining"),a=document.getElementsByClassName("replay-btn")[0];let i,r=0;[...e.boards][0].allShipsSunk()?(i=[...e.players][1].name,r=5-[...e.boards][1].sunkShips.length):(i=[...e.players][0].name,r=5-[...e.boards][0].sunkShips.length),n.textContent=`${i} Won!`,s.textContent=`${i} had ${r} left!`,t.style.display="flex",a.addEventListener("click",(()=>{location.reload()}))}()}function S(){return"assets/sfx/we-are-8-bit.mp3"===s.song?function(){const e=new Audio("assets/sfx/we-are-8-bit.mp3");return e.loop=!0,e}():"assets/sfx/cant-escape-fight-8-bit.mp3"===s.song?function(){const e=new Audio("assets/sfx/cant-escape-fight-8-bit.mp3");return e.loop=!0,e}():void 0}function b(){const e=document.getElementById("options-menu"),t=document.getElementById("menu");document.getElementById("credits-scroll").style.display="none",e.style.display="none",t.style.display="flex"}!function(){const t=document.getElementById("play"),n=document.getElementById("play-card");t.addEventListener("click",(()=>{n.style.display="none",function(){s.currentlyPlaying=S(),s.currentlyPlaying.play();const t=document.getElementById("menu");t.style.display="flex";const n=document.getElementById("pvc"),i=document.getElementById("multiplayer"),r=document.getElementById("options"),l=document.getElementById("single-player-name"),c=document.getElementById("multiplayer-name"),d=document.getElementById("return-to-menu");n.addEventListener("click",(()=>{e.mode="PvC",l.style.display="flex",c.style.display="none"})),i.addEventListener("click",(()=>{e.mode="PvP",l.style.display="none",c.style.display="flex"})),r.addEventListener("click",(()=>{const e=document.getElementById("options-menu"),n=document.getElementById("credits"),a=document.getElementById("credits-scroll"),i=document.getElementById("music"),r=document.getElementById("sfx-modal");i.addEventListener("click",(()=>{r.style.display="flex",function(){document.getElementById("music"),document.getElementById("sfx-modal");const e=document.getElementById("high-volume"),t=document.getElementById("medium-volume"),n=document.getElementById("low-volume"),a=document.getElementById("we-are"),i=document.getElementById("cant-escape");e.addEventListener("click",(()=>{e.classList.add("selected"),t.classList.remove("selected"),n.classList.remove("selected"),s.volume=1,s.currentlyPlaying.volume=s.volume})),t.addEventListener("click",(()=>{e.classList.remove("selected"),t.classList.add("selected"),n.classList.remove("selected"),s.volume=.66,s.currentlyPlaying.volume=s.volume})),n.addEventListener("click",(()=>{e.classList.remove("selected"),t.classList.remove("selected"),n.classList.add("selected"),s.volume=.33,s.currentlyPlaying.volume=s.volume})),a.addEventListener("click",(()=>{a.classList.add("selected"),i.classList.remove("selected"),s.song="assets/sfx/we-are-8-bit.mp3",s.currentlyPlaying.pause(),s.currentlyPlaying={},s.currentlyPlaying=S(),s.currentlyPlaying.volume=s.volume,s.currentlyPlaying.play()})),i.addEventListener("click",(()=>{i.classList.add("selected"),a.classList.remove("selected"),s.song="assets/sfx/cant-escape-fight-8-bit.mp3",s.currentlyPlaying.pause(),s.currentlyPlaying={},s.currentlyPlaying=S(),s.currentlyPlaying.volume=s.volume,s.currentlyPlaying.play()}))}(),i.style.display="none",n.style.display="none"})),n.addEventListener("click",(()=>{a.style.display="flex"})),t.style.display="none",e.style.display="flex",d.addEventListener("click",(()=>{b(),r.style.display="none",i.style.display="flex",n.style.display="flex"})),window.addEventListener("keypress",(function(e){"Enter"===e.key&&(b(),r.style.display="none",i.style.display="flex",n.style.display="flex")}))})),function(){const t=document.getElementById("new-game-btn-solo"),n=document.getElementById("new-game-btn-multiplayer"),s=(document.getElementById("single-player-name"),document.getElementById("multiplayer-name"),document.getElementById("menu")),i=document.getElementById("placement-page-body-container"),r=document.getElementById("single-player-input"),l=document.getElementById("player1-input"),c=document.getElementById("player2-input");t.addEventListener("click",(()=>{let t=new a(r.value),n=new a("Computer");e.players.push(t),e.players.push(n);const l=new o(r.value),c=new o("Computer");e.boards.push(l),e.boards.push(c),i.style.display="flex",s.style.display="none",E()})),n.addEventListener("click",(()=>{let t=new a(l.value),n=new a(c.value);e.players.push(t),e.players.push(n);const r=new o(l.value),d=new o(c.value);e.boards.push(r),e.boards.push(d),i.style.display="flex",s.style.display="none",E()}))}()}()}))}()})();